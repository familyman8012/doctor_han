# Home Screen (v1) - 룰 기반 자동 구성

## 목적
- 메인 페이지를 “완성된 느낌”으로 구성하기 위해, 프론트엔드가 조립해서 렌더링할 수 있는 **섹션(블록) 기반 API 계약**을 먼저 고정한다.
- 초기에는 운영자 편집(섹션/배너/노출기간 관리)을 넣지 않고도, **시드 데이터만 채우면 그럴듯하게 보이는 홈 구성**을 제공한다.
- 이후 운영자 편집/홈 전면 개편을 하더라도, **도메인 데이터(업체/카테고리/리뷰) 마이그레이션 부담 없이** 확장할 수 있도록 설계한다.

## 핵심 결정사항
- 홈 카드의 기본 단위는 **업체(Provider/Vendor) 카드**를 기준으로 한다.
  - B2B 매칭의 핵심 의사결정 단위는 “어떤 업체에 문의/계약하는가”이기 때문.
  - 확장성 확보를 위해 업체 1:N 구조로 **오퍼(Offering, 서비스/패키지/프로젝트)** 도입을 권장하되, v1 홈은 업체 카드 중심으로 간다.
- 홈 운영 방식은 **룰 기반 자동 구성**으로 시작한다.
  - `home_sections/home_section_items/banners` 같은 운영자 편집 테이블은 v1에서 제외.
- CTA(홈 카드의 기본 행동)는 **상담요청(리드)** 중심으로 설계한다.
  - 인기/추천 지표도 장기적으로 “문의/클릭”이 자연스러운 기준이 된다.
- 카테고리는 **대/소(2뎁스) + 트리 구조(parent_id)** 를 기본으로 한다.
  - UI는 당분간 2뎁스 중심으로 보여주되, 스키마는 트리로 유지(이미 `categories.parent_id`).

## 홈 화면 데이터 원칙
- 홈은 “테이블에 박제된 페이지”가 아니라 **도메인 데이터에서 파생되는 Feed/View**다.
- 홈 전용 컬럼을 `vendors` 같은 도메인 테이블에 무분별하게 추가하지 않는다.
  - 예: `is_home`, `home_rank` 같은 필드 금지
  - 예외: 대표 이미지처럼 “업체 자체 속성”이면 도메인 속성으로 인정 가능
- 응답은 **섹션 조립형**으로 내려준다.
  - v1은 룰 기반으로 채우고, v2 이후 운영자 편집이 생기면 “섹션 정의/구성”의 데이터 소스만 바꾼다.

## API 계약(권장)
- `GET /api/home?v=1`
- 응답은 `sections[]` 기반으로 구성한다.
  - 섹션별로 `id/type/title/items[]`를 제공하고, 프론트는 `type`에 따라 렌더링한다.
  - 이후 전면 개편 시에도 **`/api/home` 계약 유지**가 목표.

### Section Types (v1)
- `category_grid`: 메인 카테고리 그리드
- `vendor_carousel`: 업체 카드 리스트(가로 캐러셀/그리드 모두 가능)

### Vendor Card 최소 필드(홈 노출 기준)
- `대표 이미지(썸네일)` (fileId 또는 url)
- `업체명`
- `한줄소개(summary)` (가능하면 필수)
- `카테고리` (최소 1개)
- `지역(region)` (가능하면)
- `평점/리뷰수` (없으면 0)
- `대표 오퍼(가격은 협의/범위 가능)`는 v1에서 선택(추후 오퍼 도입 시 확장)

## 홈 섹션 구성안(초안)
> 섹션 수/순서는 v1에서 코드/설정으로 고정하고, 아이템은 룰로 자동 선정한다.

1. 카테고리 그리드 (`category_grid`)
2. 추천 파트너 (`vendor_carousel`)
3. 이번 달 인기 (`vendor_carousel`)
4. 리뷰로 검증 (`vendor_carousel`)
5. 신규 입점 (`vendor_carousel`)
6. 카테고리별 추천 (`vendor_carousel`, 대카테고리 N개)

## 자동 선정/랭킹 규칙(초안)
- 공통 필터
  - `vendor_public`(활성 + 승인)만 노출
  - 썸네일 없는 업체는 우선 제외(부족하면 fallback)
- 중복 노출 제한
  - 동일 업체는 **최대 2개 섹션**까지 등장하도록 제한(부족하면 완화)
- 섹션별 기준
  - 추천: 프로필 완성도(요약/지역/카테고리/이미지) + 평점/리뷰 보정(가중치)
  - 인기: 초기(v1)는 `review_count`, `rating_avg` 중심으로 근사(데이터가 쌓이면 클릭/문의 기반으로 전환)
  - 리뷰로 검증: `rating_avg` 단독이 아니라 `review_count`를 함께 고려(예: 최소 리뷰수 조건, 베이지안 보정)
  - 신규: `created_at` 최신순
  - 카테고리별: 해당 카테고리의 상위 업체를 우선(이미지/완성도 우선)
- Fallback 전략
  - 섹션별 목표 개수(예: 8개)를 못 채우면, 다음 풀(추천 → 인기 → 신규)에서 순차 보충

## 시드 데이터 가이드(“보기 좋게 차는 기준”)
- 카테고리
  - 대카테고리 6~8개 이상
  - 소카테고리는 대카테고리당 3~8개 정도부터 시작해도 충분
- 업체
  - 홈 섹션당 8개씩 채운다고 가정하면, 최소 40~80개 정도면 “차 있는 느낌”이 난다.
  - 업체당 대표 이미지 1장 + 추가 이미지 2장 이상(포트폴리오 자산 활용)
  - 상위 업체 몇 개만 리뷰 3~20개 정도 있어도 섹션 퀄리티가 상승한다.

## 운영자 편집으로의 확장(미래 대비)
- 목표: v1(룰 기반) → v1.5(핀 몇 개 + 룰 채우기) → v2(운영자 편집)
- 확장 시 추가될 스키마(예시)
  - `home_sections`: 섹션 메타(순서/타입/제목/노출기간)
  - `home_section_items`: 섹션에 고정/큐레이션된 아이템(업체/오퍼/배너 등)
  - `banners`: 배너 관리(이미지/링크/기간)
- 중요한 점
  - 기존 `vendors/categories/reviews`를 마이그레이션하는 구조가 아니라,
  - **새 테이블을 추가**하고 `/api/home`의 “아이템 소스”만 룰 → 편집으로 바꾸는 구조로 간다.

## 다음 단계 제안
- 홈용 `GET /api/home` 구현(섹션 조립형 응답)
- 홈 카드 렌더링에 필요한 최소 정보(썸네일/카테고리/평점)를 포함
- 추후 “인기” 고도화용 이벤트/집계(클릭/문의/저장) 테이블 및 주기적 집계(배치/트리거) 도입

