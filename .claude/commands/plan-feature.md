---
description: "기능에 대한 종합적인 구현 계획 생성"
---

# 기능 계획: $ARGUMENTS

## 미션

기능 요청을 체계적인 코드베이스 분석과 전략적 계획을 통해 **종합적인 구현 계획**으로 변환합니다.

**핵심 원칙**: 이 단계에서는 코드를 작성하지 않습니다. AI 에이전트가 한 번에 구현을 성공할 수 있는 컨텍스트가 풍부한 계획을 만드는 것이 목표입니다.

## 계획 프로세스

### Phase 1: 기능 이해

**기능 분석:**
- 해결하려는 핵심 문제 파악
- 사용자 가치 및 비즈니스 영향 식별
- 기능 유형: 신규 기능/개선/리팩토링/버그 수정
- 복잡도: 낮음/중간/높음
- 영향받는 시스템 및 컴포넌트 매핑

**사용자 스토리 형식:**
```
<사용자 유형>으로서
나는 <행동/목표>를 원합니다
왜냐하면 <혜택/가치> 때문입니다
```

### Phase 2: 코드베이스 분석

**1. 프로젝트 구조 분석**
- 디렉토리 구조 및 아키텍처 패턴 파악
- 서비스/컴포넌트 경계 및 통합 포인트 식별
- 설정 파일 위치 확인

**2. 패턴 인식**
- 코드베이스에서 유사한 구현 검색
- 코딩 컨벤션 확인:
  - 네이밍 패턴
  - 파일 구조
  - 에러 처리 방식
  - 로깅 패턴
- CLAUDE.md의 프로젝트 규칙 확인

**3. 의존성 분석**
- 기능 관련 외부 라이브러리 확인
- 라이브러리 통합 방식 파악
- `.claude/reference/` 문서 참조

**4. 테스트 패턴**
- 테스트 프레임워크 및 구조 확인
- 유사 테스트 예제 찾기

**5. 통합 포인트**
- 업데이트가 필요한 기존 파일 식별
- 생성해야 할 새 파일 및 위치 결정
- API 라우트 등록 패턴 파악

### Phase 3: 관련 문서 확인

**도메인 PRD 확인:**
- `app/doc/domains/*/prd.md` - 관련 도메인 요구사항

**참조 문서:**
- `.claude/reference/nextjs-patterns.md` - API Route, App Router
- `.claude/reference/supabase-patterns.md` - DB, Auth, Storage
- `.claude/reference/frontend-patterns.md` - React Query, 폼
- `.claude/reference/coding-conventions.md` - 코딩 스타일

### Phase 4: 전략적 사고

**고려 사항:**
- 이 기능이 기존 아키텍처에 어떻게 맞는가?
- 핵심 의존성과 작업 순서는?
- 엣지 케이스, 에러 상황은?
- 어떻게 테스트할 것인가?
- 성능, 보안 고려사항은?

### Phase 5: 계획 문서 생성

## 출력 형식

**파일명**: `.agents/plans/{kebab-case-기능명}.md`

**템플릿 구조:**

```markdown
# Feature: <기능명>

## 기능 설명
<기능의 상세 설명, 목적, 사용자 가치>

## 사용자 스토리
<사용자 유형>으로서 나는 <목표>를 원합니다. 왜냐하면 <가치> 때문입니다.

## 기능 메타데이터
- **유형**: [신규 기능/개선/리팩토링/버그 수정]
- **복잡도**: [낮음/중간/높음]
- **영향 시스템**: [컴포넌트/서비스 목록]

---

## 컨텍스트 참조

### 필수 참조 파일 (구현 전 반드시 읽을 것!)
- `path/to/file.ts` (lines X-Y) - Why: 미러링할 패턴
- `path/to/model.ts` - Why: DB 모델 구조

### 생성할 파일
- `app/src/app/api/xxx/route.ts` - API 엔드포인트
- `app/src/app/(main)/xxx/page.tsx` - 페이지 컴포넌트

### 따라야 할 패턴
<코드베이스에서 추출한 구체적인 패턴>

---

## 구현 계획

### Phase 1: 기반 작업
- [ ] 스키마/타입 정의
- [ ] 의존성 설정

### Phase 2: 핵심 구현
- [ ] 비즈니스 로직
- [ ] API 엔드포인트
- [ ] 데이터 모델

### Phase 3: 통합
- [ ] 라우터 연결
- [ ] 컴포넌트 등록

### Phase 4: 테스트
- [ ] 단위 테스트
- [ ] 통합 테스트

---

## 단계별 작업

### 1. CREATE `app/src/lib/schema/xxx.ts`
- **구현**: Zod 스키마 정의
- **패턴**: `app/src/lib/schema/auth.ts` 참조
- **검증**: `cd app && pnpm type-check`

### 2. CREATE `app/src/app/api/xxx/route.ts`
- **구현**: GET/POST 핸들러
- **패턴**: `app/src/app/api/vendors/route.ts` 참조
- **검증**: `curl localhost:3000/api/xxx`

<작업 계속...>

---

## 검증 명령어

### Level 1: 문법 & 스타일
\`\`\`bash
cd app
pnpm lint
pnpm type-check
\`\`\`

### Level 2: 단위 테스트
\`\`\`bash
cd app
pnpm test
\`\`\`

### Level 3: 수동 검증
<API 호출, UI 테스트 단계>

---

## 완료 기준

- [ ] 모든 기능 구현 완료
- [ ] 모든 검증 명령어 통과
- [ ] 테스트 커버리지 충족
- [ ] 코드 컨벤션 준수
- [ ] 기존 기능 회귀 없음
```

## 품질 기준

- [ ] 모든 필요한 패턴 식별 및 문서화
- [ ] 외부 라이브러리 사용법 문서화
- [ ] 통합 포인트 명확히 매핑
- [ ] 모든 작업에 검증 명령어 포함
- [ ] 작업이 의존성 순서로 정렬됨

## 완료 시 리포트

계획 생성 후 제공:
- 기능 및 접근 방식 요약
- 생성된 계획 파일 전체 경로
- 복잡도 평가
- 주요 구현 리스크
- 한 번에 성공할 신뢰도 점수 (#/10)
